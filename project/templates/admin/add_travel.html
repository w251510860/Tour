<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>添加旅游景点</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css"
          integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">

    <style>
        *{padding: 0;margin: 0;}
        .add_travel, .update_travel{
            text-align: center;
            position: absolute;
            left: 30%;
            top: 10%;
        }
        .pure-control-group label{
            font-weight: 800;
        }
        .pure-control-group input{
            width: 230px;
            height: 6vh;
            font-style: oblique;
            font-size: 12px;
        }
    </style>
    {% if data.id %}
        <script type="text/javascript">
            $(function(){
                $('.form_id').removeClass('add_travel');
                $('.form_id').addClass('update_travel');
            })
        </script>
    {% else %}
        <script type="text/javascript">
            $(function(){
                $('.form_id').removeClass('update_travel');
                $('.form_id').addClass('add_travel');
            })
        </script>
    {% endif %}
    <script>
        $(function(){
            $('.add_travel').submit(function(e){
                e.preventDefault();
                $.ajax({
                    url:"/admin/add_travel",
                    type:'POST',
                    data: $(this).serialize(),
                    success: function(resp){
                        console.log(resp.data);
                        var t = resp.data;
                        $('.travel_list').append('<tr ><td>'+ t.name +'</td><td><a href="">'+ t.website +'</a></td>'+
                            '<td>'+ t.open_time +'</td><td>'+ t.advice_time +'</td><td>'+ t.phone +'</td>'+
                            '<td>￥'+ t.price +'</td><td><a href="">操作</a></td></tr>');
                        show_tab(1);
                    },
                });
            });

            $('.update_travel').submit(function(e){
                e.preventDefault();
                var pk = $('input[name="id"]').val();
                alert(pk);
                $.ajax({
                    url:"/admin/update_travel/" + pk,
                    type:'POST',
                    data: $(this).serialize(),
                    success: function(resp){
                        console.log(resp.data);
                        window.location.href = "{{ url_for('admin.page', type=2) }}"
                    },
                });
            });

        })
    </script>

</head>
<body>
<div class="travel_t_box">
    <form class="pure-form pure-form-aligned form_id " action="">
        <fieldset>
            <label><input type="hidden" name="csrf_token" value="{{ csrf_token() }}"></label>
            {% if data.id %}
            <label><input type="hidden" id="pk" name="id" value="{{ data.id }}"></label>
            {% endif %}
            <div class="pure-control-group">
                <label for="name">景点名称:</label>
                {% if data.name %}
                    <input id="name" type="text" value="{{ data.name }}" name="name">
                {% else %}
                    <input id="name" type="text" placeholder="景点名称" name="name">
{#                <span class="pure-form-message-inline">必填</span>#}
                {% endif %}
                
            </div>

            <div class="pure-control-group">
                <label for="pic_link">景点链接:</label>
                {% if data %}
                <input id="pic_link" name="pic_link" type="text" value="{{ data.pic_link }}">
                {% else %}
                <input id="pic_link" name="pic_link" type="text">
                {% endif %}
            </div>

            <div class="pure-control-group">
                <label for="open_time">景点开门时间:</label>
                {% if data %}
                <input id="open_time" name="open_time" type="text" value="{{ data.open_time }}">
                {% else %}
                <input id="open_time" name="open_time" type="text">
                {% endif %}
                
            </div>

            <div class="pure-control-group">
                <label for="advice_time">建议游玩时长:</label>
                {% if data %}
                <input id="advice_time" name="advice_time" type="text" value="{{ data.advice_time }}">
                {% else %}
                <input id="advice_time" name="advice_time" type="text" placeholder="单位/小时">
                {% endif %}
            </div>

            <div class="pure-control-group">
                <label for="phone">联系电话:</label>
                {% if data %}
                <input id="phone" name="phone" type="number" value="{{ data.phone }}">
                {% else %}
                <input id="phone" name="phone" type="number" placeholder="11位纯数字">
                {% endif %}
            </div>

            <div class="pure-control-group">
                <label for="price">建议价格:</label>
                {% if data %}
                <input id="price" name="price" type="text" value="{{ data.price }}">
                {% else %}
                <input id="price" name="price" type="text" placeholder="人民币">
                {% endif %}
            </div>

            <div class="pure-control-group">
                <label for="website">网站地址:</label>
                {% if data %}
                <input id="website" name="website" type="text" value="{{ data.website }}">
                {% else %}
                <input id="website" name="website" type="text" placeholder="www.demo.com">
                {% endif %}
            </div>

            <div class="pure-control-group">
                <label for="place">详细地址:</label>
                {% if data %}
                <input id="place" name="place" type="text" value="{{ data.place }}">
                {% else %}
                <input id="place" name="place" type="text">
                {% endif %}
            </div>

            <div class="pure-controls">
                {% if data %}
                <button type="submit" class="pure-button pure-button-primary">更新景点信息</button>
                {% else %}
                <button type="submit" class="pure-button pure-button-primary">创建景点</button>
                {% endif %}
                
            </div>
        </fieldset>
    </form>
</div>
</body>
</html>
